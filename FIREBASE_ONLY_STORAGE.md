# üì∏ –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Ç–æ–ª—å–∫–æ –≤ Firebase Storage

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–í—Å–µ —Ñ–∞–π–ª—ã (—Ñ–æ—Ç–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã) —Ç–µ–ø–µ—Ä—å —Ö—Ä–∞–Ω—è—Ç—Å—è **–¢–û–õ–¨–ö–û –≤ Firebase Storage** –∏ –±–æ–ª—å—à–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ.

### ‚úÖ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

#### 1. **photoManager.js**
```javascript
// –û—Ç–∫–ª—é—á–µ–Ω–æ - –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–æ–ª—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
photoManager.savePhoto()     // ‚Üê —Ç–µ–ø–µ—Ä—å –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç
photoManager.deletePhoto()   // ‚Üê —Ç–µ–ø–µ—Ä—å –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç
```

#### 2. **firebaseStorage.js** (–Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)
```javascript
// –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ –∏–∑ Telegram –ü–†–Ø–ú–û –≤ Firebase
uploadPhotoFromTelegram(fileId, botToken)
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: { success: true, url, fileName, uploadedAt }

// –£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ –∏–∑ Firebase –ø–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
deletePhotoFromFirebase(fileName)

// –£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ –∏–∑ Firebase –ø–æ URL
deletePhotoFromUrl(photoUrl)
```

#### 3. **placeManager.js**
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–µ—Å—Ç–∞ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –µ–≥–æ —Ñ–æ—Ç–æ –∏–∑ Firebase
- –ß—Ç–µ–Ω–∏–µ —Ñ–æ—Ç–æ - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ URL –∏–∑ Firebase

### üìä –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ
         ‚Üì
bot.js –≤—ã–∑—ã–≤–∞–µ—Ç firebaseStorage.uploadPhotoFromTelegram()
         ‚Üì
Firebase Storage –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL
         ‚Üì
URL —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –≥–æ—Ä–æ–¥–∞, –º–µ—Å—Ç–∞)
         ‚Üì
–§–æ—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ URL –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
```

### üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—è–µ—Ç –º–µ—Å—Ç–æ
         ‚Üì
placeManager.deletePlace()
         ‚Üì
–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ñ–æ—Ç–æ: place.photos[]
         ‚Üì
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º firebaseStorage.deletePhotoFromUrl()
         ‚Üì
–§–æ—Ç–æ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ Firebase Storage
```

### üíæ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–≠–∫–æ–Ω–æ–º–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞** - –¥–∏—Å–∫ –Ω–µ –∑–∞–±–∏–≤–∞–µ—Ç—Å—è —Ñ–æ—Ç–æ  
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - Firebase –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è  
‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å** - CDN Firebase –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ –±—ã—Å—Ç—Ä–æ  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ñ–∞–π–ª—ã –∑–∞—â–∏—â–µ–Ω—ã Firebase Security Rules  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è** - Google –¥–µ–ª–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏  

### ‚ö° –§—É–Ω–∫—Ü–∏–∏ –≤—Å—ë –µ—â—ë —Ä–∞–±–æ—Ç–∞—é—Ç

- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≥–æ—Ä–æ–¥–∞/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏/–º–µ—Å—Ç–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ç–æ –≤ —Å–ø–∏—Å–∫–∞—Ö
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–µ—Å—Ç–∞
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö —Ñ–æ—Ç–æ –≤ Firebase

### üìå –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–í—Å–µ URL —Ñ–æ—Ç–æ** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ JSON –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
   ```json
   "photos": [
     {
       "url": "https://storage.googleapis.com/bucket/photos/photo_12345.jpg",
       "uploadedAt": "2026-01-21T10:30:00Z"
     }
   ]
   ```

2. **–°—Ç–∞—Ä—ã–µ —Ñ–æ—Ç–æ** (–µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ Firebase —Å –ø–æ–º–æ—â—å—é:
   ```bash
   node migrate-photos.js
   ```

3. **–ü–∞–ø–∫–∞ uploads/photos** - –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
